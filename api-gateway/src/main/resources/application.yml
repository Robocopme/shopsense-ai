server:
  port: 8080

spring:
  application:
    name: api-gateway
  redis:
    host: ${REDIS_HOST:localhost}
    port: ${REDIS_PORT:6379}
  cloud:
    gateway:
      default-filters:
        - PreserveHostHeader
      httpclient:
        connect-timeout: 5000
        response-timeout: 30s
      metrics:
        enabled: true
    circuitbreaker:
      resilience4j:
        configs:
          default:
            register-health-indicator: true
            sliding-window-type: COUNT_BASED
            sliding-window-size: 20
            minimum-number-of-calls: 10
            permitted-number-of-calls-in-half-open-state: 5
            wait-duration-in-open-state: 10s
            failure-rate-threshold: 50
            slow-call-duration-threshold: 30s
            slow-call-rate-threshold: 100
            time-limiter:
              timeout-duration: 30s
              cancel-running-future: false
        instances:
          productService:
            base-config: default
          priceService:
            base-config: default
  jackson:
    default-property-inclusion: non_null

management:
  endpoints:
    web:
      exposure:
        include: health,info,prometheus
  tracing:
    enabled: true

springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    path: /swagger

shopsense:
  jwt:
    issuer: shopsense-ai
    secret: ${JWT_SECRET:d25tgtjowQ2BDDd__RSWJkIHWp8fqCye3PL1vI72swLpeXNXGLUZi2_3zpYsTenSjETrhWgBhyAHxoqcaBunRQ==}
    expiration-seconds: 3600

logging:
  level:
    org.springframework.cloud.gateway: INFO
    reactor.netty.http.client: WARN
